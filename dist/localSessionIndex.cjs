function e(e){var n=function(e,n){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof n?n:n+""}function n(e){var n=/^([$a-zA-Z][$a-zA-Z0-9]*):\s*(\S.+)\s*$/.exec(e);if(null==n)throw new Error(e);var t=new Error(n[2]);throw t.name=n[1],t}function t(e){return"string"==typeof e||e instanceof String}var r=/^\s*$/;function i(e){return("string"==typeof e||e instanceof String)&&!r.test(e.valueOf())}var o=/^[^\x00-\x1F\x7F-\x9F\u2028\u2029\uFFF9-\uFFFB]*$/;function a(e){return function(e,n){return("string"==typeof e||e instanceof String)&&o.test(e.valueOf())}(e)}var s=!1;function u(e,t,r){var i=function(i,o){return function(e,t,r,i,o){if(null==t){if(i)return t;n("MissingArgument: no ".concat(g(e)," given"))}else if(r(t))switch(!0){case t instanceof Boolean:case t instanceof Number:case t instanceof String:return t.valueOf();default:return t}else n("InvalidArgument: the given ".concat(g(e)," is no valid ").concat(g(o)))}(i,o,e,t,r)},o=e.name;return null!=o&&/^ValueIs/.test(o)?function(e,t){if(null==e&&n("MissingArgument: no function given"),"function"!=typeof e&&n("InvalidArgument: the given 1st Argument is not a JavaScript function"),null==t&&n("MissingArgument: no desired name given"),"string"==typeof t||t instanceof String||n("InvalidArgument: the given desired name is not a string"),e.name===t)return e;try{if(Object.defineProperty(e,"name",{value:t}),e.name===t)return e}catch(e){}return new Function("originalFunction","return function "+t+" () {return originalFunction.apply(this,Array.prototype.slice.apply(arguments))}")(e)}(i,o.replace(/^ValueIs/,t?"allow":"expect")):i}var c=/*#__PURE__*/u(t,s,"literal string"),l=/*#__PURE__*/u(i,s,"non-empty literal string"),f=/*#__PURE__*/u(a,s,"single line of text");function g(e){return e.replace(/\\x[0-9a-zA-Z]{2}|\\u[0-9a-zA-Z]{4}|\\[0bfnrtv'"\\\/]?/g,function(e){return"\\"===e?"\\\\":e}).replace(/[\x00-\x1f\x7f-\x9f]/g,function(e){switch(e){case"\0":return"\\0";case"\b":return"\\b";case"\f":return"\\f";case"\n":return"\\n";case"\r":return"\\r";case"\t":return"\\t";case"\v":return"\\v";default:var n=e.charCodeAt(0).toString(16);return"\\x"+"00".slice(n.length)+n}})}function m(e){return window.automerge.isValidAutomergeUrl(e)}var v=u(m,!0,"automerge session URL"),p=v,d=u(m,s,"automerge session URL"),x=d,y=/*#__PURE__*/function(){function t(){this._Index=Object.create(null)}var r,i,o=t.prototype;return o.get=function(e){f("session name",e),l("session name",e);var n=this._Index[e];return null==n?void 0:"automerge:"+n},o.set=function(e,t){f("session name",e),l("session name",e),d("session URL",t),""===e.trim()&&n("Invalidargument: the given session name is empty"),this._Index[e]=t.replace("automerge:","")},o.delete=function(e){f("session name",e),l("session name",e),delete this._Index[e]},o.import=function(e){if(c("index serialization",e),""!==(e=e.trim())){var t;try{t=JSON.parse(e)}catch(e){return void n("InvalidArgument: the given index serialization is no valid JSON string")}for(var r in t){var i=t[r];a(r)&&""!==r.trim()&&m("automerge:"+i)&&(this._Index[r]=i)}}},o.export=function(){return JSON.stringify(this._Index)},o.preserve=function(){localStorage.setItem("Automerge Session Index",JSON.stringify(this._Index))},o.restore=function(){this._Index=Object.create(null);var e=localStorage.getItem("Automerge Session Index");if(null!=e){var n;try{n=JSON.parse(e)}catch(e){return void console.warn('localStorage["Automerge Session Index"] is broken')}for(var t in n){var r=n[t];a(t)&&""!==t.trim()&&m("automerge:"+r)&&(this._Index[t]=r)}}},r=t,(i=[{key:"NameList",get:function(){var e=[];for(var n in this._Index)e.push(n);return e},set:function(e){n('ReadOnly: the "NameList" must not be set, it will be calculated')}}])&&function(n,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,e(i.key),i)}}(r.prototype,i),Object.defineProperty(r,"prototype",{writable:!1}),r}();exports.ValueIsAutomergeURL=m,exports.allowAutomergeURL=v,exports.allowedAutomergeURL=p,exports.expectAutomergeURL=d,exports.expectedAutomergeURL=x,exports.localSessionIndex=y;
//# sourceMappingURL=localSessionIndex.cjs.map
