function n(n){var e=/^([$a-zA-Z][$a-zA-Z0-9]*):\s*(\S.+)\s*$/.exec(n);if(null==e)throw new Error(n);var t=new Error(e[2]);throw t.name=e[1],t}function e(n){return"string"==typeof n||n instanceof String}var t=/^\s*$/;function r(n){return("string"==typeof n||n instanceof String)&&!t.test(n.valueOf())}var i=/^[^\x00-\x1F\x7F-\x9F\u2028\u2029\uFFF9-\uFFFB]*$/;function a(n){return function(n,e){return("string"==typeof n||n instanceof String)&&i.test(n.valueOf())}(n)}var s=!1;function o(e,t,r){var i=function(i,a){return function(e,t,r,i,a){if(null==t){if(i)return t;n("MissingArgument: no ".concat(f(e)," given"))}else if(r(t))switch(!0){case t instanceof Boolean:case t instanceof Number:case t instanceof String:return t.valueOf();default:return t}else n("InvalidArgument: the given ".concat(f(e)," is no valid ").concat(f(a)))}(i,a,e,t,r)},a=e.name;return null!=a&&/^ValueIs/.test(a)?function(e,t){if(null==e&&n("MissingArgument: no function given"),"function"!=typeof e&&n("InvalidArgument: the given 1st Argument is not a JavaScript function"),null==t&&n("MissingArgument: no desired name given"),"string"==typeof t||t instanceof String||n("InvalidArgument: the given desired name is not a string"),e.name===t)return e;try{if(Object.defineProperty(e,"name",{value:t}),e.name===t)return e}catch(n){}return new Function("originalFunction","return function "+t+" () {return originalFunction.apply(this,Array.prototype.slice.apply(arguments))}")(e)}(i,a.replace(/^ValueIs/,t?"allow":"expect")):i}var u=/*#__PURE__*/o(e,s,"literal string"),c=/*#__PURE__*/o(r,s,"non-empty literal string"),l=/*#__PURE__*/o(a,s,"single line of text");function f(n){return n.replace(/\\x[0-9a-zA-Z]{2}|\\u[0-9a-zA-Z]{4}|\\[0bfnrtv'"\\\/]?/g,function(n){return"\\"===n?"\\\\":n}).replace(/[\x00-\x1f\x7f-\x9f]/g,function(n){switch(n){case"\0":return"\\0";case"\b":return"\\b";case"\f":return"\\f";case"\n":return"\\n";case"\r":return"\\r";case"\t":return"\\t";case"\v":return"\\v";default:var e=n.charCodeAt(0).toString(16);return"\\x"+"00".slice(e.length)+e}})}function g(n){return window.automerge.isValidAutomergeUrl(n)}var v=o(g,!0,"automerge session URL"),m=v,d=o(g,s,"automerge session URL"),x=d,p=/*#__PURE__*/function(){function e(){this._Index=Object.create(null)}var t=e.prototype;return t.get=function(n){l("session name",n),c("session name",n);var e=this._Index[n];return null==e?void 0:"automerge:"+e},t.set=function(e,t){l("session name",e),c("session name",e),d("session URL",t),""===e.trim()&&n("Invalidargument: the given session name is empty"),this._Index[e]=t.replace("automerge:","")},t.delete=function(n){l("session name",n),c("session name",n),delete this._Index[n]},t.NameList=function(){var n=[];for(var e in this._Index)n.push(e);return n},t.import=function(e){if(u("index serialization",e),""!==(e=e.trim())){var t;try{t=JSON.parse(e)}catch(e){return void n("InvalidArgument: the given index serialization is no valid JSON string")}for(var r in t){var i=t[r];g(r)&&a(i)&&""!==i.trim()&&(this._Index[r]=i)}}},t.export=function(){return JSON.stringify(this._Index)},t.preserve=function(){localStorage.setItem("Automerge Session Index",JSON.stringify(this._Index))},t.restore=function(){this._Index=Object.create(null);var n=localStorage.getItem("Automerge Session Index");if(null!=n){var e;try{e=JSON.parse(n)}catch(n){return void console.warn('localStorage["Automerge Session Index"] is broken')}for(var t in e){var r=e[t];g(t)&&a(r)&&""!==r.trim()&&(this._Index[t]=r)}}},e}();export{g as ValueIsAutomergeURL,v as allowAutomergeURL,m as allowedAutomergeURL,d as expectAutomergeURL,x as expectedAutomergeURL,p as localSessionIndex};
//# sourceMappingURL=localSessionIndex.esm.js.map
